{{ define "discord.default.title" }}
{{- if eq .Status "firing" -}}
ğŸš¨ {{ .CommonLabels.severity | upper }} Alert: {{ .CommonLabels.alertname }}
{{- else -}}
âœ… Resolved: {{ .CommonLabels.alertname }}
{{- end -}}
{{ end }}

{{ define "discord.default.description" }}
{{ range .Alerts }}
{{- if eq .Status "firing" }}
**ğŸ”¥ Alert Details:**
**Summary:** {{ .Annotations.summary }}
**Description:** {{ .Annotations.description }}
**Service:** `{{ .Labels.service }}`
**Severity:** `{{ .Labels.severity }}`
**Category:** `{{ .Labels.category | default "general" }}`
**Team:** `{{ .Labels.team | default "engineering" }}`
**Started:** {{ .StartsAt.Format "2006-01-02 15:04:05 UTC" }}

{{- if .Annotations.impact }}
**ğŸ’¥ Impact:** {{ .Annotations.impact }}
{{- end }}

{{- if .Annotations.runbook_url }}
**ğŸ“– Runbook:** {{ .Annotations.runbook_url }}
{{- end }}

**ğŸ¯ Next Steps:**
1. Acknowledge this alert
2. Follow runbook procedures
3. Update team on progress
{{- else }}
**âœ… Issue Resolved**
**Alert:** {{ .Annotations.summary }}
**Duration:** {{ .StartsAt.Format "15:04" }} - {{ .EndsAt.Format "15:04" }} ({{ .EndsAt.Sub .StartsAt | humanize }})
**Service:** `{{ .Labels.service }}`
{{- end }}
{{ end }}
{{ end }}

{{ define "discord.critical.title" }}
ğŸš¨ğŸš¨ CRITICAL ALERT: {{ .CommonLabels.alertname }} ğŸš¨ğŸš¨
{{ end }}

{{ define "discord.critical.description" }}
{{ range .Alerts }}
**ğŸš¨ CRITICAL ALERT - IMMEDIATE ACTION REQUIRED**

**Alert:** {{ .Annotations.summary }}
**Description:** {{ .Annotations.description }}
**Service:** `{{ .Labels.service }}`
**Instance:** `{{ .Labels.instance | default "N/A" }}`
**Started:** {{ .StartsAt.Format "2006-01-02 15:04:05 UTC" }}

{{- if .Annotations.impact }}
**ğŸ”¥ BUSINESS IMPACT:** {{ .Annotations.impact }}
{{- end }}

{{- if .Annotations.runbook_url }}
**ğŸ“– EMERGENCY PROCEDURES:** {{ .Annotations.runbook_url }}
{{- end }}

**ğŸš¨ IMMEDIATE ACTION PLAN:**
```
1. âœ… Acknowledge alert immediately
2. ğŸ” Follow emergency runbook
3. ğŸ“¢ Notify incident commander
4. ğŸ¯ Begin mitigation steps
5. ğŸ“ Update status every 15 minutes
```

**â° Escalation:** Auto-escalate in 15 minutes if not resolved
**ğŸ“ Emergency Contact:** Page on-call engineer immediately
{{ end }}
{{ end }}

{{ define "discord.business.title" }}
ğŸ“Š Business Metric Alert: {{ .CommonLabels.alertname }}
{{ end }}

{{ define "discord.business.description" }}
{{ range .Alerts }}
**ğŸ“Š Business Intelligence Alert**

**Metric:** {{ .Annotations.summary }}
**Details:** {{ .Annotations.description }}
**Service:** `{{ .Labels.service }}`
**Category:** `{{ .Labels.category }}`
**Team:** `{{ .Labels.team }}`
**Detected:** {{ .StartsAt.Format "2006-01-02 15:04:05 UTC" }}

{{- if .Annotations.impact }}
**ğŸ’° Business Impact:** {{ .Annotations.impact }}
{{- end }}

**ğŸ“ˆ Analysis Required:**
```
â€¢ Review dashboard metrics
â€¢ Analyze user behavior trends  
â€¢ Check marketing campaign impact
â€¢ Investigate external factors
â€¢ Assess competitive landscape
```

{{- if .Annotations.runbook_url }}
**ğŸ“‹ Analysis Playbook:** {{ .Annotations.runbook_url }}
{{- end }}

**ğŸ‘¥ Stakeholders:** Product, Growth, Engineering teams
{{ end }}
{{ end }}

{{ define "discord.mobile.title" }}
ğŸ“± Mobile App Alert: {{ .CommonLabels.alertname }}
{{ end }}

{{ define "discord.mobile.description" }}
{{ range .Alerts }}
**ğŸ“± Mobile Application Alert**

**Issue:** {{ .Annotations.summary }}
**Details:** {{ .Annotations.description }}
**Platform:** `{{ .Labels.platform | default "iOS/Android" }}`
**App Version:** `{{ .Labels.app_version | default "Multiple versions" }}`
**Detected:** {{ .StartsAt.Format "2006-01-02 15:04:05 UTC" }}

{{- if .Annotations.impact }}
**ğŸ“‰ User Impact:** {{ .Annotations.impact }}
{{- end }}

**ğŸ”§ Mobile Team Checklist:**
```
â˜ Check crash reporting tools
â˜ Review recent app releases  
â˜ Monitor app store reviews
â˜ Verify device compatibility
â˜ Test on affected platforms
â˜ Prepare hotfix if needed
```

{{- if .Annotations.runbook_url }}
**ğŸ“± Mobile Response Guide:** {{ .Annotations.runbook_url }}
{{- end }}

**ğŸ¯ Priority:** Address mobile issues quickly to prevent app store rating impact
{{ end }}
{{ end }}

{{ define "discord.security.title" }}
ğŸ”’ SECURITY INCIDENT: {{ .CommonLabels.alertname }} ğŸ”’
{{ end }}

{{ define "discord.security.description" }}
{{ range .Alerts }}
**ğŸ”’ SECURITY INCIDENT DETECTED**

**Security Event:** {{ .Annotations.summary }}
**Details:** {{ .Annotations.description }}
**Source IP:** `{{ .Labels.source_ip | default "Unknown" }}`
**Service:** `{{ .Labels.service }}`
**Detected:** {{ .StartsAt.Format "2006-01-02 15:04:05 UTC" }}

{{- if .Annotations.impact }}
**ğŸš¨ Security Impact:** {{ .Annotations.impact }}
{{- end }}

**ğŸ›¡ï¸ SECURITY RESPONSE PROTOCOL:**
```
ğŸ” INVESTIGATE (0-10 min):
  â˜ Analyze attack pattern
  â˜ Identify scope and impact
  â˜ Check related logs

ğŸš« CONTAIN (10-20 min):
  â˜ Block malicious IPs
  â˜ Disable compromised accounts
  â˜ Isolate affected systems

ğŸ“ DOCUMENT (ongoing):
  â˜ Log all actions taken
  â˜ Preserve evidence
  â˜ Update incident timeline

ğŸ“ ESCALATE (if needed):
  â˜ Notify security team lead
  â˜ Contact CISO for critical incidents
  â˜ Prepare legal/compliance notifications
```

{{- if .Annotations.runbook_url }}
**ğŸ›¡ï¸ Security Incident Procedures:** {{ .Annotations.runbook_url }}
{{- end }}

**âš ï¸ Remember:** Follow incident response procedures and maintain chain of custody for any evidence
{{ end }}
{{ end }}

{{ define "discord.sla.title" }}
ğŸ“Š SLA VIOLATION: {{ .CommonLabels.alertname }}
{{ end }}

{{ define "discord.sla.description" }}
{{ range .Alerts }}
**ğŸ“Š SERVICE LEVEL AGREEMENT VIOLATION**

**SLA Breach:** {{ .Annotations.summary }}
**Details:** {{ .Annotations.description }}
**Service:** `{{ .Labels.service }}`
**SLA Tier:** `{{ .Labels.sla_tier | default "Standard" }}`
**Violation Started:** {{ .StartsAt.Format "2006-01-02 15:04:05 UTC" }}

{{- if .Annotations.impact }}
**ğŸ’¼ Customer Impact:** {{ .Annotations.impact }}
{{- end }}

**ğŸ“‹ SLA VIOLATION RESPONSE:**
```
â±ï¸ IMMEDIATE (0-15 min):
  â˜ Acknowledge SLA violation
  â˜ Begin rapid resolution efforts
  â˜ Notify customer success team

ğŸ“ COMMUNICATION (15-30 min):
  â˜ Prepare customer notifications
  â˜ Update status page
  â˜ Notify affected enterprise customers

ğŸ’° FINANCIAL (post-resolution):
  â˜ Calculate service credits owed
  â˜ Update SLA violation tracking
  â˜ Review customer impact assessment

ğŸ“ˆ PROCESS (24-48 hours):
  â˜ Schedule post-incident review
  â˜ Update SLA procedures if needed
  â˜ Implement preventive measures
```

{{- if .Annotations.runbook_url }}
**ğŸ“Š SLA Response Procedures:** {{ .Annotations.runbook_url }}
{{- end }}

**âš ï¸ Note:** This violation may trigger customer credits and require executive notification
{{ end }}
{{ end }}

{{ define "discord.color" }}
{{- if eq .Status "firing" -}}
  {{- if eq .CommonLabels.severity "critical" -}}
    16711680
  {{- else if eq .CommonLabels.severity "warning" -}}
    16776960
  {{- else -}}
    4886754
  {{- end -}}
{{- else -}}
  5763719
{{- end -}}
{{ end }}